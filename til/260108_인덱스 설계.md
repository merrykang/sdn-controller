### 아래처럼 인덱스 설계 하는 이유: 인덱스 설계 3개 원칙 지켜야함
- WHERE에 쓰이는 컬럼만 인덱스
- = → BETWEEN → ORDER BY 순서
- 집계 테이블은 단순해야 빠르다

```java
@Table(name = "sw_conf_ports_stat_d", indexes = {
        @Index(name = "idx_d_mgmt_timestamp", columnList = "mgmt_ip, `timestamp`"),
        @Index(name = "idx_d_full_search", columnList = "mgmt_ip, port_index, `timestamp` DESC")})
```

---

### 실제 조회 + ui 에서 어떤 집계 데이터가 필요한지를 고려해서 인덱스 걸어야함
#### 포트별 그래프 : @Index(name = "idx_d_full_search", columnList = "mgmt_ip, port_index, `timestamp` DESC")
#### 일반 그래프 : @Index(name = "idx_d_mgmt_timestamp", columnList = "mgmt_ip, `timestamp`"),
#### 왜냐하면 실제로 쓰이는 sql이 아래와 같기 때문

```sql
WHERE mgmt_ip = ?
  AND port_index = ?
  AND timestamp BETWEEN ? AND ?
ORDER BY timestamp ASC|DESC
```

---

- 8백만개 행에 대한 인덱스 생성 시간은 약 50초이다. 광주 현장 서버 기준